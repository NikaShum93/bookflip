<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>BookFlip Viewer</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/css/page-flip.min.css">

<style>
  html, body {
    margin:0; padding:0;
    width:100%; height:100%;
    overflow:hidden;
    background:transparent;
  }
  #book {
    width:100%; height:100%;
    background:transparent;
  }
  .page img {
    width:100%; height:100%;
    object-fit:contain;
    display:block;
  }
</style>
</head>
<body>

<div id="book"></div>

<audio id="flipSound" src="https://raw.githubusercontent.com/NikaShum93/bookflip/main/flip.mp3" preload="auto"></audio>

<script src="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/js/page-flip.browser.min.js"></script>
<script>
(async function(){

  // параметры из URL
  const params = new URLSearchParams(location.search);
  const pages = (params.get("pages")||"").split(",").filter(Boolean);
  const w = parseInt(params.get("w")||600);
  const h = parseInt(params.get("h")||900);

  // создаём книгу
  const book = new St.PageFlip(document.getElementById("book"), {
    width: w,         // ширина одной страницы
    height: h,        // высота страницы
    size: "fixed",
    maxShadowOpacity: 0.5,
    showCover: true,  // включаем обложку
    mobileScrollSupport: false
  });

  // готовим HTML страниц
  const items = pages.map((url,i)=>({
    type:"html",
    html:`<div class="page"><img src="${url}" alt="page${i+1}"></div>`
  }));

  // загружаем
  book.loadFromHTML(items.map(x=>x.html));

  // звук
  const flipSound = document.getElementById("flipSound");
  book.on("flip",()=>{ flipSound.currentTime=0; flipSound.play(); });

})();
</script>

</body>
</html>
